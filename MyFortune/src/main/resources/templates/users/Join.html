<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{/layout/commonLayout}"
      xmlns="http://www.w3.org/1999/html">

<!-- Main Content -->
<th:block layout:fragment="content">
    <h1>회원가입</h1>
    <label for="idInp">아이디</label><input type="text" name="id" id="idInp"/>
    <button type="button" onclick="checkDuplication();">중복확인</button>
    <br/>
    <label for="pwdInp">비밀번호</label>
    <input type="password" name="password" id="pwdInp"/>
    <br/>
    <label for="rePwdInp">비밀번호 재입력</label>
    <input type="password" id="rePwdInp"/>
    <br/>
    <label for="nickNmImp">닉네임</label>
    <input type="text" id="nickNmImp" />
</th:block>

<script type="text/javascript">

    let isCheckedId = false;

    function checkDuplication(){
        const newId = document.getElementById('idInp').value();
        if(newId) {
            alert('아이디를 입력해주세요.');
            return;
        }

        window.fetch('/id/exists?newId=' + id,{
            method: 'get',

        }).then((response) => response.json())
        .then((result) => {
            isCheckedId = !result.data;
            if(result.data) {
                alert('중복된 아이디입니다.');
                document.getElementById('idInp').focus();
            }
        }).catch((error) => {
            alert('처리를 실패했습니다.');
            console.log(error);
        });

    }
</script>
</html>